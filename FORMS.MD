## Forms

## What is CSRF?

Cross-Site Request Forgery (CSRF) is an attack that occurs when a malicious website tricks a user's browser into sending an unwanted request to another website where the user is authenticated (logged in). This can lead to unauthorized actions being taken without the user's consent

### How CSRF Works

User Authentication: Imagine you’re logged into your bank account in one tab of your web browser.

Visiting a Malicious Site: Now, you visit a different website that is controlled by an attacker. This site has malicious code (like an HTML form or a script) that can send requests to your bank.

Unintended Request: The malicious site sends a request to the bank’s server, like transferring money from your account, using your authentication cookie (the one that identifies you as logged in). Since your browser automatically includes cookies for sites you're logged into, the bank thinks you are making this request intentionally.

Result: If the bank server doesn’t have protections against this, it will process the request as if it were you making it. You could unintentionally transfer money without even knowing it.

### How CSRF Works in Django:

Django has built-in mechanisms to protect against CSRF attacks:

CSRF Token: Each form that modifies data (like submitting a comment or making a purchase) must include a special token known as the CSRF token. This token is a random value generated by the server and is unique to each user session.

Including the Token: You include the CSRF token in your forms using {% csrf_token %} in your HTML templates. For example:

```html
<form method="post">
	{% csrf_token %}
	<input type="text" name="message" required />
	<button type="submit">Send</button>
</form>
```

Validation on the Server: When the form is submitted, Django checks if the CSRF token is present and valid:

If the token is valid, the server processes the request.
If the token is missing or invalid, Django rejects the request and raises a CSRF error, preventing any actions from being taken.

### Why CSRF Protection is Important

Prevents Unauthorized Actions: By requiring a CSRF token for every sensitive action, Django ensures that requests come from legitimate sources (your own site) rather than a malicious site.
Protects User Accounts: It helps safeguard users' accounts and sensitive operations from being exploited by attackers.

## Summary

CSRF is an attack that tricks a user's browser into making unauthorized requests.
Django protects against CSRF by requiring a CSRF token in forms, ensuring that only legitimate requests are processed.

`./template/contact`

```html
{% extends "base.html" %} {%block start%}

<nav style="padding: 4rem">
	<a href="{%url 'index'%}">home</a>
	<a href="{%url 'about'%}">about</a>
</nav>
{% include "image.html" %}
<h1>Hello from contact page</h1>
<p>name: Hooshmandlab</p>
<p>address: server</p>
<p>field: educational technology</p>

<form action="" method="POST">
	{%csrf_token%} {{form}}
	<button type="submit">submit</button>
</form>
{%endblock%}
```

We are just simply getting the data and if valid, print it.

```py
def contact(request):

    if request.method=="POST":
        # get the info from posted request
        form = ContactForm(request.POST)
        if form.is_valid():
            print(form.cleaned_data)
    form = ContactForm()
    context = {"form":form}
    return render(request, "contact.html", context=context)
```

`is_valid()` method is called on the ContactForm instance. If the form data is valid (i.e., all required fields are filled out correctly), it proceeds to the next step.

`redirect` is crucial here, otherwise the user will stay on the same page if the page is reloaded, the same data will be submitted to the server.

### How to store data in our database?

- Create a model matching required fields when form was created.
